<!-- <img class="banner" src="http://getwallpapers.com/wallpaper/full/1/3/3/599741.jpg"> -->
<img class="banner" src="/assets/images/servers/{{server.address}}`{{server.port}}.png">
<div *ngIf="server">
  <div class="container"><h1 class="title"><a class="btn icon" style="position:relative;margin-right:8px;top:-4px;color:#EEE" (click)="location.back()">&#xE830;</a>{{server.title}}</h1></div>
  <div class="container" style="background-color:var(--bg)">
    <div #header class="header" [class.header-fixed]="fixedHeader">
      <div><button class="mobile-hide play" (click)="selectTeam = true" title="Requires BZFlag Launcher">&#9658; Play</button></div>
      <div *ngIf="fixedHeader"><a class="btn icon" style="position:relative;margin-right:8px;top:2px" (click)="location.back()">&#xE830;</a>{{server.title}}</div>
      <div *ngIf="!fixedHeader" style="position:relative;bottom:2px"><img src="https://countryflags.io/{{server.countryCode}}/flat/32.png" style="margin-bottom:-10px;margin-right:6px" alt=""> <b>{{server.country}}</b></div>
      <div *ngIf="!fixedHeader" style="position:relative;top:4px"><b>Updated</b><br><small>{{server.timestamp | timeAgo}}</small></div>
    </div>
    <div class="content">
      <app-table>
        <tr>
          <th>Online</th>
          <td><span [outerHTML]="server.online | booleanYesNo"></span></td>
        </tr>
        <tr>
          <th>Server</th>
          <td>{{server.address}}:{{server.port}}</td>
        </tr>
        <tr>
          <th>IP Address</th>
          <td>{{server.ip}}</td>
        </tr>
        <tr>
          <th>Owner</th>
          <td>{{server.owner}}</td>
        </tr>
        <tr>
          <th>Protocol</th>
          <td>{{server.protocol}}</td>
        </tr>
        <tr>
          <th>Game Style</th>
          <td>{{server.configuration.gameStyle | verboseGameStyle}}</td>
        </tr>
        <tr>
          <th>Max shots</th>
          <td>{{server.configuration.maxShots}}</td>
        </tr>
        <tr>
          <th>Max Players</th>
          <td>{{server.configuration.maxPlayers}}</td>
        </tr>
        <tr>
          <th>Flags</th>
          <td><span [outerHTML]="server.configuration.superflags | booleanYesNo"></span></td>
        </tr>
        <tr>
          <th>Antidote Flags</th>
          <td><span [outerHTML]="server.configuration.antidoteFlags | booleanYesNo"></span></td>
        </tr>
        <tr>
          <th>No Team Kills</th>
          <td><span [outerHTML]="server.configuration.noTeamKills | booleanYesNo"></span></td>
        </tr>
        <tr>
          <th>Jumping</th>
          <td><span [outerHTML]="server.configuration.jumping | booleanYesNo"></span></td>
        </tr>
        <tr>
          <th>Ricochet</th>
          <td><span [outerHTML]="server.configuration.ricochet | booleanYesNo"></span></td>
        </tr>
        <tr>
          <th>Drop Bad Flags</th>
          <td><span [outerHTML]="server.configuration.shaking | booleanYesNo"></span></td>
        </tr>
        <tr *ngIf="server.configuration.shaking">
          <th>Drop Bad Flags After</th>
          <td>{{server.configuration.dropBadFlags.wins}} wins or {{server.configuration.dropBadFlags.time}} seconds</td>
        </tr>
        <tr>
          <th>Inertia</th>
          <td><span [outerHTML]="server.configuration.inertia | booleanYesNo"></span></td>
        </tr>
        <tr>
          <th>Handicap</th>
          <td><span [outerHTML]="server.configuration.handicap | booleanYesNo"></span></td>
        </tr>
        <tr>
          <th>Time Limit</th>
          <td><span [outerHTML]="server.configuration.timeLimit | numberZeroNo"></span></td>
        </tr>
        <tr>
          <th>Max Player Score</th>
          <td><span [outerHTML]="server.configuration.maxPlayerScore | numberZeroNo"></span></td>
        </tr>
        <tr>
          <th>Max Team Score</th>
          <td><span [outerHTML]="server.configuration.maxTeamScore | numberZeroNo"></span></td>
        </tr>
      </app-table>
      <div *ngIf="server.players" style="margin-top:18px">
        <h2>{{playerCount + " Player" | autoPlural}} and {{observerCount + " Observer" | autoPlural}} Online</h2>
        <app-players-table *ngIf="playerCount > 0 || observerCount > 0" [players]="server.players" [showTkColumn]="!server.configuration.noTeamKills"></app-players-table>
      </div>
      <div *ngIf="!server.players" style="margin-top:18px">
        <h2>No Players Online</h2>
      </div>
      <div style="margin-top:18px">
        <h2>Teams</h2>
        <app-table id="teams">
          <tr>
            <th (click)="teamSortBy('name')">Name</th>
            <th (click)="teamSortBy('score')">Score</th>
            <th (click)="teamSortBy('players')">Players</th>
            <th (click)="teamSortBy('wins')">Wins</th>
            <th (click)="teamSortBy('losses')">Losses</th>
          </tr>
          <tr *ngFor="let team of server.teams">
            <td>{{team.name}}</td>
            <td>{{team.name !== "Observer" ? team.wins - team.losses : "N/A"}}</td>
            <td>{{team.players}} / {{team.maxPlayers}}</td>
            <td>{{team.name !== "Observer" ? team.wins : "N/A"}}</td>
            <td>{{team.name !== "Observer" ? team.losses : "N/A"}}</td>
          </tr>
        </app-table>
      </div>
    </div>
  </div>
</div>
<div *ngIf="badAddress" class="container">
  <h1>Server <i>{{address}}:{{port}}</i> is not in the database</h1>
  <a routerLink="/">Home</a>
</div>
<div *ngIf="selectTeam" class="play-popup">
  <span class="helper"></span>
  <div>
    <button class="btn icon" (click)="selectTeam = false">&#xE711;</button>
    <h3>Select Team</h3><br>
    <button *ngFor="let team of server.teams" class="btn outline" (click)="joinTeam(team.name)">{{team.name}}</button>
  </div>
</div>
<app-spinner [show]="!server && !badAddress"></app-spinner>